<!doctype html>
<html>
  <head>
    <title>測試隨機化</title>
  </head>
  <body>
    <h1>測試隨機化功能</h1>
    <div id="result"></div>

    <script>
      // 模擬 randomizeNodeValues 函數
      function randomizeNodeValues(nodes) {
        console.log('🎲 開始隨機化節點數值，原始節點數量:', nodes.length);
        const randomizedNodes = nodes.map((node) => {
          const newValue = Math.floor(Math.random() * 5) + 1; // 生成 1-5 的隨機數
          console.log(
            `🎲 節點 ${node.coord?.x},${node.coord?.y} 從 ${node.value} 變為 ${newValue}`
          );
          return {
            ...node,
            value: newValue,
          };
        });
        console.log('🎲 隨機化完成，前3個節點:', randomizedNodes.slice(0, 3));
        return randomizedNodes;
      }

      // 載入並處理數據
      fetch('/schematic-map-rwd/data/taipei/taipei_schematic.json')
        .then((response) => response.json())
        .then((data) => {
          console.log('原始數據前3個節點:', data[0].nodes.slice(0, 3));

          // 隨機化處理
          const processedData = data.map((line) => ({
            ...line,
            nodes: randomizeNodeValues(line.nodes),
          }));

          console.log('處理後數據前3個節點:', processedData[0].nodes.slice(0, 3));

          // 顯示結果
          document.getElementById('result').innerHTML = `
                    <h2>原始數據前3個節點:</h2>
                    <pre>${JSON.stringify(data[0].nodes.slice(0, 3), null, 2)}</pre>
                    <h2>處理後數據前3個節點:</h2>
                    <pre>${JSON.stringify(processedData[0].nodes.slice(0, 3), null, 2)}</pre>
                `;
        })
        .catch((error) => {
          console.error('錯誤:', error);
          document.getElementById('result').innerHTML = '<p>載入數據時發生錯誤</p>';
        });
    </script>
  </body>
</html>
