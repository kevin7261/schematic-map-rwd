<!doctype html>
<html>
  <head>
    <title>æ¸¬è©¦éš¨æ©ŸåŒ–</title>
  </head>
  <body>
    <h1>æ¸¬è©¦éš¨æ©ŸåŒ–åŠŸèƒ½</h1>
    <div id="result"></div>

    <script>
      // æ¨¡æ“¬ randomizeNodeValues å‡½æ•¸
      function randomizeNodeValues(nodes) {
        console.log('ğŸ² é–‹å§‹éš¨æ©ŸåŒ–ç¯€é»æ•¸å€¼ï¼ŒåŸå§‹ç¯€é»æ•¸é‡:', nodes.length);
        const randomizedNodes = nodes.map((node) => {
          const newValue = Math.floor(Math.random() * 5) + 1; // ç”Ÿæˆ 1-5 çš„éš¨æ©Ÿæ•¸
          console.log(
            `ğŸ² ç¯€é» ${node.coord?.x},${node.coord?.y} å¾ ${node.value} è®Šç‚º ${newValue}`
          );
          return {
            ...node,
            value: newValue,
          };
        });
        console.log('ğŸ² éš¨æ©ŸåŒ–å®Œæˆï¼Œå‰3å€‹ç¯€é»:', randomizedNodes.slice(0, 3));
        return randomizedNodes;
      }

      // è¼‰å…¥ä¸¦è™•ç†æ•¸æ“š
      fetch('/schematic-map-rwd/data/taipei/taipei_schematic.json')
        .then((response) => response.json())
        .then((data) => {
          console.log('åŸå§‹æ•¸æ“šå‰3å€‹ç¯€é»:', data[0].nodes.slice(0, 3));

          // éš¨æ©ŸåŒ–è™•ç†
          const processedData = data.map((line) => ({
            ...line,
            nodes: randomizeNodeValues(line.nodes),
          }));

          console.log('è™•ç†å¾Œæ•¸æ“šå‰3å€‹ç¯€é»:', processedData[0].nodes.slice(0, 3));

          // é¡¯ç¤ºçµæœ
          document.getElementById('result').innerHTML = `
                    <h2>åŸå§‹æ•¸æ“šå‰3å€‹ç¯€é»:</h2>
                    <pre>${JSON.stringify(data[0].nodes.slice(0, 3), null, 2)}</pre>
                    <h2>è™•ç†å¾Œæ•¸æ“šå‰3å€‹ç¯€é»:</h2>
                    <pre>${JSON.stringify(processedData[0].nodes.slice(0, 3), null, 2)}</pre>
                `;
        })
        .catch((error) => {
          console.error('éŒ¯èª¤:', error);
          document.getElementById('result').innerHTML = '<p>è¼‰å…¥æ•¸æ“šæ™‚ç™¼ç”ŸéŒ¯èª¤</p>';
        });
    </script>
  </body>
</html>
